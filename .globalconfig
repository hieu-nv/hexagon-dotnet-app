is_global = true

# Hexagon .NET App - Global Analyzer Configuration
# This file replaces the HexagonApp.ruleset with the modern .globalconfig approach

# Microsoft .NET Analyzers - Performance Rules (Warning Level)
dotnet_diagnostic.CA1304.severity = warning   # Specify CultureInfo
dotnet_diagnostic.CA1305.severity = warning   # Specify IFormatProvider
dotnet_diagnostic.CA1307.severity = warning   # Specify StringComparison
dotnet_diagnostic.CA1310.severity = warning   # Specify StringComparison for correctness
dotnet_diagnostic.CA1822.severity = suggestion # Mark members as static
dotnet_diagnostic.CA1825.severity = warning   # Avoid zero-length array allocations
dotnet_diagnostic.CA1826.severity = warning   # Do not use Count() when Any() can be used
dotnet_diagnostic.CA1827.severity = warning   # Do not use Count() or LongCount() when Any() can be used
dotnet_diagnostic.CA1829.severity = warning   # Use Length/Count property instead of Count()
dotnet_diagnostic.CA1834.severity = warning   # Consider using 'StringBuilder.Append(char)'
dotnet_diagnostic.CA1835.severity = warning   # Prefer the 'Memory'-based overloads
dotnet_diagnostic.CA1836.severity = warning   # Prefer IsEmpty over Count
dotnet_diagnostic.CA1841.severity = warning   # Prefer Dictionary.Contains methods
dotnet_diagnostic.CA1845.severity = warning   # Use span-based 'string.Concat'
dotnet_diagnostic.CA1846.severity = warning   # Prefer 'AsSpan' over 'Substring'
dotnet_diagnostic.CA1847.severity = warning   # Use char literal for single character lookup

# Microsoft .NET Analyzers - Security Rules (Error Level)
dotnet_diagnostic.CA2100.severity = error     # Review SQL queries for security vulnerabilities
dotnet_diagnostic.CA2300.severity = error     # Do not use insecure deserializer BinaryFormatter
dotnet_diagnostic.CA2301.severity = error     # Do not call BinaryFormatter.Deserialize
dotnet_diagnostic.CA2305.severity = error     # Do not use insecure deserializer LosFormatter
dotnet_diagnostic.CA2310.severity = error     # Do not use insecure deserializer NetDataContractSerializer
dotnet_diagnostic.CA2315.severity = error     # Do not use insecure deserializer ObjectStateFormatter
dotnet_diagnostic.CA2321.severity = error     # Do not deserialize with JavaScriptSerializer
dotnet_diagnostic.CA2322.severity = error     # Ensure JavaScriptSerializer is not initialized with SimpleTypeResolver

# Microsoft .NET Analyzers - Design Rules
dotnet_diagnostic.CA1031.severity = suggestion # Do not catch general exception types
dotnet_diagnostic.CA1062.severity = suggestion # Validate arguments of public methods
dotnet_diagnostic.CA1040.severity = none      # Avoid empty interfaces (marker interfaces are OK)
dotnet_diagnostic.CA1034.severity = suggestion # Nested types should not be visible

# Microsoft .NET Analyzers - Documentation Rules
dotnet_diagnostic.CA1591.severity = none      # Missing XML comment (handled by CS1591)

# Microsoft .NET Analyzers - Async Rules
dotnet_diagnostic.CA2016.severity = warning   # Forward the 'CancellationToken' parameter
dotnet_diagnostic.CA2007.severity = none      # Consider calling ConfigureAwait (not needed in .NET Core)

# SonarAnalyzer - Security Rules (Error Level)
dotnet_diagnostic.S2068.severity = error      # Credentials should not be hard-coded
dotnet_diagnostic.S2092.severity = error      # Cookies should be secure
dotnet_diagnostic.S4426.severity = error      # Cryptographic keys should be robust
dotnet_diagnostic.S4507.severity = error      # Delivering code in production with debug features
dotnet_diagnostic.S4784.severity = error      # Using regular expressions is security-sensitive
dotnet_diagnostic.S4790.severity = error      # Using weak hashing algorithms
dotnet_diagnostic.S5332.severity = error      # Using clear-text protocols
dotnet_diagnostic.S5659.severity = error      # JWT should be signed and verified

# SonarAnalyzer - Code Quality Rules (Warning Level)
dotnet_diagnostic.S1075.severity = warning    # URIs should not be hardcoded
dotnet_diagnostic.S1118.severity = suggestion # Utility classes should not have public constructors
dotnet_diagnostic.S1144.severity = warning    # Unused private types or members should be removed
dotnet_diagnostic.S1172.severity = warning    # Unused method parameters should be removed
dotnet_diagnostic.S1186.severity = warning    # Methods should not be empty
dotnet_diagnostic.S1481.severity = warning    # Unused local variables should be removed
dotnet_diagnostic.S1854.severity = warning    # Unused assignments should be removed
dotnet_diagnostic.S2094.severity = warning    # Classes should not be empty
dotnet_diagnostic.S2259.severity = error      # Null pointers should not be dereferenced
dotnet_diagnostic.S2292.severity = suggestion # Trivial properties should be auto-implemented
dotnet_diagnostic.S2583.severity = error      # Conditionally executed code should be reachable
dotnet_diagnostic.S2589.severity = warning    # Boolean expressions should not be gratuitous
dotnet_diagnostic.S2737.severity = warning    # "catch" clauses should do more than rethrow
dotnet_diagnostic.S3052.severity = warning    # Remove redundant initialization
dotnet_diagnostic.S3168.severity = warning    # "async" methods should not return "void"
dotnet_diagnostic.S3216.severity = warning    # "ConfigureAwait(false)" should be used
dotnet_diagnostic.S3776.severity = warning    # Cognitive Complexity of methods should not be too high
dotnet_diagnostic.S3881.severity = warning    # "IDisposable" should be implemented correctly
dotnet_diagnostic.S3898.severity = suggestion # Value types should implement "IEquatable<T>"
dotnet_diagnostic.S3900.severity = warning    # Arguments of public methods should be validated against null
dotnet_diagnostic.S4456.severity = warning    # Parameter validation in "async"/"await" methods should be wrapped

# SonarAnalyzer - Code Style Rules (Suggestion Level)
dotnet_diagnostic.S1134.severity = suggestion # Track uses of "FIXME" tags
dotnet_diagnostic.S1135.severity = suggestion # Track uses of "TODO" tags
dotnet_diagnostic.S1309.severity = warning    # Do not suppress issues
dotnet_diagnostic.S1940.severity = suggestion # Boolean checks should not be inverted
dotnet_diagnostic.S2178.severity = suggestion # Short-circuit logic should be used in boolean contexts
dotnet_diagnostic.S2971.severity = suggestion # "IEnumerable" LINQs should be simplified
dotnet_diagnostic.S3267.severity = suggestion # Loops should be simplified with "LINQ" expressions
dotnet_diagnostic.S6966.severity = warning    # Await RunAsync instead
dotnet_diagnostic.S927.severity = suggestion  # Parameter names should match base declaration

# SonarAnalyzer - Test-specific rules (more lenient)
dotnet_diagnostic.S2699.severity = suggestion # Tests should include assertions
dotnet_diagnostic.S3431.severity = suggestion # "ExpectedExceptionAttribute" should not be used
dotnet_diagnostic.S3433.severity = suggestion # Test methods should have correct signatures

# Security Code Scan Rules - Critical Security (Error Level)
dotnet_diagnostic.SCS0001.severity = error    # Command injection possible
dotnet_diagnostic.SCS0002.severity = error    # SQL injection
dotnet_diagnostic.SCS0003.severity = error    # XPath injection
dotnet_diagnostic.SCS0004.severity = error    # Certificate validation has been disabled
dotnet_diagnostic.SCS0008.severity = error    # Cookie without HttpOnly flag
dotnet_diagnostic.SCS0009.severity = error    # Cookie without Secure flag
dotnet_diagnostic.SCS0017.severity = error    # Request validation has been disabled

# Security Code Scan Rules - Security Warnings
dotnet_diagnostic.SCS0005.severity = warning  # Weak random generator
dotnet_diagnostic.SCS0006.severity = warning  # Weak hashing function
dotnet_diagnostic.SCS0007.severity = warning  # XML parsing vulnerable to XXE
dotnet_diagnostic.SCS0010.severity = warning  # Weak cipher algorithm
dotnet_diagnostic.SCS0011.severity = warning  # CBC padding oracle
dotnet_diagnostic.SCS0012.severity = warning  # Weak cipher mode
dotnet_diagnostic.SCS0013.severity = warning  # Weak cipher IV
dotnet_diagnostic.SCS0014.severity = warning  # Hardcoded password
dotnet_diagnostic.SCS0015.severity = warning  # Hardcoded connection string
dotnet_diagnostic.SCS0016.severity = warning  # Controller method is potentially vulnerable to authorization bypass
dotnet_diagnostic.SCS0018.severity = warning  # Path traversal
dotnet_diagnostic.SCS0019.severity = warning  # OutputCache conflict
dotnet_diagnostic.SCS0020.severity = warning  # Weak cipher key size

# Additional Microsoft .NET Analyzers for improved code quality
dotnet_diagnostic.CA1308.severity = warning   # Normalize strings to uppercase
dotnet_diagnostic.CA1309.severity = warning   # Use ordinal string comparison
dotnet_diagnostic.CA1824.severity = warning   # Mark assemblies with NeutralResourcesLanguageAttribute
dotnet_diagnostic.CA1828.severity = warning   # Do not use CountAsync() when AnyAsync() can be used
dotnet_diagnostic.CA1830.severity = warning   # Prefer strongly-typed Append/Insert methods on StringBuilder
dotnet_diagnostic.CA1831.severity = warning   # Use AsSpan or AsMemory instead of Range-based indexers
dotnet_diagnostic.CA1832.severity = warning   # Use AsSpan or AsMemory instead of Range-based indexers
dotnet_diagnostic.CA1833.severity = warning   # Use AsSpan or AsMemory instead of Range-based indexers
dotnet_diagnostic.CA1837.severity = warning   # Use 'Environment.ProcessPath'
dotnet_diagnostic.CA1838.severity = warning   # Avoid 'StringBuilder' parameters for P/Invokes
dotnet_diagnostic.CA1839.severity = warning   # Use 'Environment.ProcessPath'
dotnet_diagnostic.CA1840.severity = warning   # Use 'Environment.CurrentManagedThreadId'
dotnet_diagnostic.CA1842.severity = warning   # Do not use 'WhenAll' with a single task
dotnet_diagnostic.CA1843.severity = warning   # Do not use 'WaitAll' with a single task
dotnet_diagnostic.CA1844.severity = warning   # Provide memory-based overrides of async methods when subclassing 'Stream'

# Additional SonarAnalyzer rules for better code quality
dotnet_diagnostic.S1066.severity = warning    # Collapsible "if" statements should be merged
dotnet_diagnostic.S1067.severity = warning    # Expressions should not be too complex
dotnet_diagnostic.S1151.severity = warning    # "switch case" clauses should not have too many lines of code
dotnet_diagnostic.S1479.severity = warning    # "switch" statements should not have too many "case" clauses
dotnet_diagnostic.S1541.severity = warning    # Methods and properties should not be too complex
dotnet_diagnostic.S1858.severity = warning    # "ToString()" calls should not be redundant
dotnet_diagnostic.S2190.severity = warning    # Recursion should not be infinite
dotnet_diagnostic.S2234.severity = warning    # Parameters should be passed in the correct order
dotnet_diagnostic.S2326.severity = warning    # Unused type parameters should be removed
dotnet_diagnostic.S2681.severity = error      # Multiline blocks should be enclosed in curly braces
dotnet_diagnostic.S2757.severity = warning    # "=+" should not be used instead of "+="
dotnet_diagnostic.S2760.severity = warning    # Sequential tests should not check the same condition
dotnet_diagnostic.S2995.severity = warning    # "Object.ReferenceEquals" should not be used for value types
dotnet_diagnostic.S3246.severity = warning    # Generic type parameters should be co/contravariant when possible
dotnet_diagnostic.S3247.severity = warning    # Duplicate casts should not be made
dotnet_diagnostic.S3249.severity = warning    # Classes directly extending "object" should not call "base" in "GetHashCode" or "Equals"
dotnet_diagnostic.S3256.severity = warning    # "string.IsNullOrEmpty" should be used
dotnet_diagnostic.S3257.severity = warning    # Declarations and initializations should be as concise as possible
dotnet_diagnostic.S3261.severity = warning    # Namespaces should not be empty
dotnet_diagnostic.S3262.severity = warning    # "params" should be used instead of "__arglist"
dotnet_diagnostic.S3263.severity = warning    # Static fields should appear before instance fields